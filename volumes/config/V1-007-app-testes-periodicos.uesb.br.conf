<VirtualHost *:443>
    ServerName app-testes-periodicos.uesb.br

    # For  ar HTTPS para todos os recursos
    Header always set Content-Security-Policy "upgrade-insecure-requests"
    LimitRequestBody 21474836480
    # 20GB em bytes
    Timeout 3600
    # 1 hora
    # Logs
    ErrorLog /var/log/apache2/periodicos2-error.log
    CustomLog /var/log/apache2/periodicos2.log combined

    # Proxy para o servi  o processo-especial
    ProxyPass "/" "http://ojs-periodicos/"
    ProxyPassReverse "/" "http://ojs-periodicos/"

    # Configura    es para arquivos est  ticos
    ProxyPassMatch "^/(.*\.(css|js|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot|map|pdf|blob))$" "http://ojs-periodicos/$1"

    # Permiss  es de acesso
    <Location "/">
        Require all granted
    </Location>

    Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "no-referrer"


    # Configura    es de Proxy Preserve
    ProxyPreserveHost On
    RequestHeader set X-Forwarded-Proto https
    RequestHeader set X-Forwarded-Port 443
    # Configura    o SSL
    SSLEngine on
    SSLProtocol all -SSLv2 -SSLv3
    SSLCipherSuite HIGH:!aNULL:!MD5
    SSLOptions +StrictRequire
    SSLCertificateFile /data/certs/letsencrypt/live/uesb.br/fullchain.pem
    SSLCertificateKeyFile /data/certs/letsencrypt/live/uesb.br/privkey.pem
    SSLCertificateChainFile /data/certs/letsencrypt/live/uesb.br/chain.pem

</VirtualHost>
